<?xml version="1.0" encoding="UTF-8"?>
<job xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="../job.xsd">

	<jobName>PARTIZIONE MOVIMENTO CREATE</jobName>
	<isThread>false</isThread>

	<task>
		<id>1</id>
		<name>CREATE TABLE PART_MOVIMENTO and COPY DATA</name>

		<sqlProcess>

			<sql><![CDATA[
				CREATE TABLE PART_MOVIMENTO
				(	
					IDRAPPORTO NUMBER NOT NULL ENABLE, 
					NUMREG VARCHAR2(256 BYTE) NOT NULL ENABLE, 
					CAMBIO FLOAT(126), 
					CAUSALE VARCHAR2(256 BYTE), 
					CODICETITOLO VARCHAR2(256 BYTE) NOT NULL ENABLE, 
					CTV FLOAT(126), 
					CTVDIVISA FLOAT(126), 
					CTVNETTO FLOAT(126), 
					DATA NUMBER NOT NULL ENABLE, 
					DATACONT NUMBER, 
					DATADISP NUMBER, 
					DATALIQ NUMBER, 
					DIVISA VARCHAR2(256 BYTE), 
					FLAGPCT VARCHAR2(3 BYTE), 
					PAESE VARCHAR2(256 BYTE), 
					PIAZZA VARCHAR2(256 BYTE), 
					PREZZO FLOAT(126), 
					QTA FLOAT(126), 
					RATEOLORDO FLOAT(126), 
					RATEONETTO FLOAT(126), 
					SPESECOMM FLOAT(126), 
					TASSAZIONE FLOAT(126), 
					TASSO FLOAT(126), 
					VALUTA NUMBER, 
					STORNO VARCHAR2(3 BYTE), 
					IICLVLE FLOAT(126), 
					IICLVLI FLOAT(126), 
					IIMLVLE FLOAT(126), 
					IIMLVLI FLOAT(126), 
					IIIPPRR FLOAT(126), 
					IIIPCAM FLOAT(126), 
					IRCLANI FLOAT(126), 
					IICLANI FLOAT(126), 
					ICOMCVR FLOAT(126), 
					ICOMCVL FLOAT(126), 
					ICOSCVR FLOAT(126), 
					ICOSCVL FLOAT(126), 
					ISPECVR FLOAT(126), 
					ISPECVL FLOAT(126), 
					ICOMVAL FLOAT(126), 
					ICOMVAR FLOAT(126), 
					IBLLESR FLOAT(126), 
					IBLLITA FLOAT(126), 
					IBLLEST FLOAT(126), 
					IBLLFSS FLOAT(126), 
					ITLQ FLOAT(126), 
					PRCLVLE FLOAT(126), 
					PRCLVLI FLOAT(126), 
					PCOFAMM FLOAT(126), 
					PCOFOAT FLOAT(126), 
					IRCCVLI FLOAT(126), 
					CDIVTRZ VARCHAR2(256 BYTE), 
					CTVORIG FLOAT(126), 
					CTV_MERCATO FLOAT(126), 
					CTV_MERCATO_DIVISA FLOAT(126), 
					DATA_REGISTRAZIONE NUMBER, 
					DATA_SOTTOSCRIZIONE NUMBER, 
					PREZZO_MERCATO FLOAT(126), 
					N_OPERAZIONE_STORNO VARCHAR2(256 BYTE), 
					F_CANCELLATO VARCHAR2(256 BYTE), 
					C_CANALE VARCHAR2(256 BYTE), 
					Z_CANALE VARCHAR2(256 BYTE), 
					QTA_CAPITALE FLOAT(126), 
					PROVENIENZACAUSALE VARCHAR2(256 BYTE), 
					D_AGGIORNAMENTO NUMBER, 
					C_PROCEDURA VARCHAR2(256 BYTE), 
					BANCA_DA VARCHAR2(256 BYTE), 
					CODICEAGENZIA_DA VARCHAR2(256 BYTE), 
					CODICERAPPORTO_DA VARCHAR2(256 BYTE), 
					BANCA_A VARCHAR2(256 BYTE), 
					CODICEAGENZIA_A VARCHAR2(256 BYTE), 
					CODICERAPPORTO_A VARCHAR2(256 BYTE), 
					FLAG_FITTIZIOCOSTI VARCHAR2(1 BYTE) DEFAULT 'N', 
					SSA VARCHAR2(8 BYTE), 
					CODICE_ABI VARCHAR2(5 BYTE), 
					CODICERAPPORTO_ORI VARCHAR2(256 BYTE), 
					FONTE VARCHAR2(5 BYTE), 
					CAUSALE_ORI VARCHAR2(256 BYTE), 
					CODICE_PRODOTTO_UNIVERSO VARCHAR2(256 BYTE), 
					RAMO VARCHAR2(256 BYTE), 
					DATA_EFFETTO_TITOLO DATE, 
					DATA_EFFETTO_POLIZZA DATE, 
					DATA_SCADENZA DATE, 
					PREMIO_NETTO FLOAT(126), 
					PREMIO_PURO FLOAT(126), 
					PREMIO_IMPONIBILE FLOAT(126), 
					CARICAMENTO FLOAT(126), 
					DIRITTO_FISSO FLOAT(126), 
					PROVV_ACQUISTO FLOAT(126), 
					PROVV_INCASSO FLOAT(126), 
					DATA_CARICO DATE, 
					INTERESSE_MORA FLOAT(126), 
					RIT_INTERESSE_MORA FLOAT(126), 
					ALTRI_COSTI FLOAT(126), 
					COSTO_LIQUIDAZIONE FLOAT(126), 
					IMPOSTA_SOSTITUTIVA FLOAT(126), 
					IMPOSTA_BOLLO FLOAT(126), 
					COD_MOTIVOSTORNO_PZ VARCHAR2(256 BYTE), 
					CODICE_FISCALE_BENEFICIARIO VARCHAR2(256 BYTE), 
					DATA_COMPETENZA VARCHAR2(256 BYTE), 
					DATA_COMUNICAZIONE_PAGAMENTO VARCHAR2(256 BYTE), 
					MODALITA_PAGAMENTO VARCHAR2(256 BYTE), 
					CODICE_FRAZIONAMENTO VARCHAR2(256 BYTE), 
					PROVVIGIONI_DI_ACQUISTO_ORI FLOAT(126), 
					PROVVIGIONI_DI_INCASSO_ORI FLOAT(126), 
					CARICAMENTO_ORI FLOAT(126)
				)
				PCTFREE 30
				PARTITION BY HASH (IDRAPPORTO)
				(
					partition MOV_01 tablespace TS_RENDIMPC_MOVS_01,
					partition MOV_02 tablespace TS_RENDIMPC_MOVS_02,
					partition MOV_03 tablespace TS_RENDIMPC_MOVS_03,
					partition MOV_04 tablespace TS_RENDIMPC_MOVS_04,
					partition MOV_05 tablespace TS_RENDIMPC_MOVS_05,
					partition MOV_06 tablespace TS_RENDIMPC_MOVS_06,
					partition MOV_07 tablespace TS_RENDIMPC_MOVS_07,
					partition MOV_08 tablespace TS_RENDIMPC_MOVS_08,
					partition MOV_09 tablespace TS_RENDIMPC_MOVS_09,
					partition MOV_10 tablespace TS_RENDIMPC_MOVS_10,
					partition MOV_11 tablespace TS_RENDIMPC_MOVS_11,
					partition MOV_12 tablespace TS_RENDIMPC_MOVS_12,
					partition MOV_13 tablespace TS_RENDIMPC_MOVS_13,
					partition MOV_14 tablespace TS_RENDIMPC_MOVS_14,
					partition MOV_15 tablespace TS_RENDIMPC_MOVS_15,
					partition MOV_16 tablespace TS_RENDIMPC_MOVS_16,
					partition MOV_17 tablespace TS_RENDIMPC_MOVS_17,
					partition MOV_18 tablespace TS_RENDIMPC_MOVS_18,
					partition MOV_19 tablespace TS_RENDIMPC_MOVS_19,
					partition MOV_20 tablespace TS_RENDIMPC_MOVS_20 
				)
			]]></sql>


			<sql><![CDATA[
				ALTER TABLE RENDIMPC.PART_MOVIMENTO NOLOGGING
			]]></sql>
			
			<sql><![CDATA[
				ALTER TABLE RENDIMPC.MOVIMENTO NOLOGGING
			]]></sql>
			
			<sql><![CDATA[
				BEGIN
					EXECUTE IMMEDIATE 'ALTER SESSION ENABLE PARALLEL DML';
					EXECUTE IMMEDIATE 'ALTER SESSION ENABLE PARALLEL QUERY';
					EXECUTE IMMEDIATE 'ALTER SESSION SET PARALLEL_FORCE_LOCAL=FALSE';
				END;
 			]]></sql>

			<sql><![CDATA[
				INSERT /*+ APPEND NOLOGGING PARALLEL (SALDO_REND,20) */ INTO PART_MOVIMENTO 
						(IDRAPPORTO, 
							NUMREG, 
							CAMBIO, 
							CAUSALE, 
							CODICETITOLO, 
							CTV, 
							CTVDIVISA, 
							CTVNETTO, 
							DATA, 
							DATACONT, 
							DATADISP, 
							DATALIQ, 
							DIVISA, 
							FLAGPCT, 
							PAESE, 
							PIAZZA, 
							PREZZO, 
							QTA, 
							RATEOLORDO, 
							RATEONETTO, 
							SPESECOMM, 
							TASSAZIONE, 
							TASSO, 
							VALUTA, 
							STORNO, 
							IICLVLE, 
							IICLVLI, 
							IIMLVLE, 
							IIMLVLI, 
							IIIPPRR, 
							IIIPCAM, 
							IRCLANI, 
							IICLANI, 
							ICOMCVR, 
							ICOMCVL, 
							ICOSCVR, 
							ICOSCVL, 
							ISPECVR, 
							ISPECVL, 
							ICOMVAL, 
							ICOMVAR, 
							IBLLESR, 
							IBLLITA, 
							IBLLEST, 
							IBLLFSS, 
							ITLQ, 
							PRCLVLE, 
							PRCLVLI, 
							PCOFAMM, 
							PCOFOAT, 
							IRCCVLI, 
							CDIVTRZ, 
							CTVORIG, 
							CTV_MERCATO, 
							CTV_MERCATO_DIVISA, 
							DATA_REGISTRAZIONE, 
							DATA_SOTTOSCRIZIONE, 
							PREZZO_MERCATO, 
							N_OPERAZIONE_STORNO, 
							F_CANCELLATO, 
							C_CANALE, 
							Z_CANALE, 
							QTA_CAPITALE, 
							PROVENIENZACAUSALE, 
							D_AGGIORNAMENTO, 
							C_PROCEDURA, 
							BANCA_DA, 
							CODICEAGENZIA_DA, 
							CODICERAPPORTO_DA, 
							BANCA_A, 
							CODICEAGENZIA_A, 
							CODICERAPPORTO_A, 
							FLAG_FITTIZIOCOSTI, 
							SSA, 
							CODICE_ABI, 
							CODICERAPPORTO_ORI, 
							FONTE, 
							CAUSALE_ORI, 
							CODICE_PRODOTTO_UNIVERSO, 
							RAMO, 
							DATA_EFFETTO_TITOLO, 
							DATA_EFFETTO_POLIZZA, 
							DATA_SCADENZA, 
							PREMIO_NETTO, 
							PREMIO_PURO, 
							PREMIO_IMPONIBILE, 
							CARICAMENTO, 
							DIRITTO_FISSO, 
							PROVV_ACQUISTO, 
							PROVV_INCASSO, 
							DATA_CARICO, 
							INTERESSE_MORA, 
							RIT_INTERESSE_MORA, 
							ALTRI_COSTI, 
							COSTO_LIQUIDAZIONE, 
							IMPOSTA_SOSTITUTIVA, 
							IMPOSTA_BOLLO, 
							COD_MOTIVOSTORNO_PZ, 
							CODICE_FISCALE_BENEFICIARIO, 
							DATA_COMPETENZA, 
							DATA_COMUNICAZIONE_PAGAMENTO, 
							MODALITA_PAGAMENTO, 
							CODICE_FRAZIONAMENTO, 
							PROVVIGIONI_DI_ACQUISTO_ORI, 
							PROVVIGIONI_DI_INCASSO_ORI, 
							CARICAMENTO_ORI)
				SELECT /*+ PARALLEL(SALDO_REND,20) */ 
						IDRAPPORTO, 
							NUMREG, 
							CAMBIO, 
							CAUSALE, 
							CODICETITOLO, 
							CTV, 
							CTVDIVISA, 
							CTVNETTO, 
							DATA, 
							DATACONT, 
							DATADISP, 
							DATALIQ, 
							DIVISA, 
							FLAGPCT, 
							PAESE, 
							PIAZZA, 
							PREZZO, 
							QTA, 
							RATEOLORDO, 
							RATEONETTO, 
							SPESECOMM, 
							TASSAZIONE, 
							TASSO, 
							VALUTA, 
							STORNO, 
							IICLVLE, 
							IICLVLI, 
							IIMLVLE, 
							IIMLVLI, 
							IIIPPRR, 
							IIIPCAM, 
							IRCLANI, 
							IICLANI, 
							ICOMCVR, 
							ICOMCVL, 
							ICOSCVR, 
							ICOSCVL, 
							ISPECVR, 
							ISPECVL, 
							ICOMVAL, 
							ICOMVAR, 
							IBLLESR, 
							IBLLITA, 
							IBLLEST, 
							IBLLFSS, 
							ITLQ, 
							PRCLVLE, 
							PRCLVLI, 
							PCOFAMM, 
							PCOFOAT, 
							IRCCVLI, 
							CDIVTRZ, 
							CTVORIG, 
							CTV_MERCATO, 
							CTV_MERCATO_DIVISA, 
							DATA_REGISTRAZIONE, 
							DATA_SOTTOSCRIZIONE, 
							PREZZO_MERCATO, 
							N_OPERAZIONE_STORNO, 
							F_CANCELLATO, 
							C_CANALE, 
							Z_CANALE, 
							QTA_CAPITALE, 
							PROVENIENZACAUSALE, 
							D_AGGIORNAMENTO, 
							C_PROCEDURA, 
							BANCA_DA, 
							CODICEAGENZIA_DA, 
							CODICERAPPORTO_DA, 
							BANCA_A, 
							CODICEAGENZIA_A, 
							CODICERAPPORTO_A, 
							FLAG_FITTIZIOCOSTI, 
							SSA, 
							CODICE_ABI, 
							CODICERAPPORTO_ORI, 
							FONTE, 
							CAUSALE_ORI, 
							CODICE_PRODOTTO_UNIVERSO, 
							RAMO, 
							DATA_EFFETTO_TITOLO, 
							DATA_EFFETTO_POLIZZA, 
							DATA_SCADENZA, 
							PREMIO_NETTO, 
							PREMIO_PURO, 
							PREMIO_IMPONIBILE, 
							CARICAMENTO, 
							DIRITTO_FISSO, 
							PROVV_ACQUISTO, 
							PROVV_INCASSO, 
							DATA_CARICO, 
							INTERESSE_MORA, 
							RIT_INTERESSE_MORA, 
							ALTRI_COSTI, 
							COSTO_LIQUIDAZIONE, 
							IMPOSTA_SOSTITUTIVA, 
							IMPOSTA_BOLLO, 
							COD_MOTIVOSTORNO_PZ, 
							CODICE_FISCALE_BENEFICIARIO, 
							DATA_COMPETENZA, 
							DATA_COMUNICAZIONE_PAGAMENTO, 
							MODALITA_PAGAMENTO, 
							CODICE_FRAZIONAMENTO, 
							PROVVIGIONI_DI_ACQUISTO_ORI, 
							PROVVIGIONI_DI_INCASSO_ORI, 
							CARICAMENTO_ORI
					FROM MOVIMENTO
			]]></sql>

		</sqlProcess>
	</task>

</job>
