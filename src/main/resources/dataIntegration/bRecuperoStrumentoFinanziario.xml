<?xml version="1.0" encoding="UTF-8"?>
<job xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="job.xsd" variablePrefix="%">
	<jobName>Recupero StrumentoFinanziario</jobName>
	<isThread>false</isThread>
 	
 	<task>
		<id>1</id>
		<name>Recupero Strumentofinanziario da BKP</name>
		<sqlProcess>
			<sql><![CDATA[
				DELETE FROM STRUMENTOFINANZIARIO WHERE CODICETITOLO NOT IN (SELECT CODICETITOLO FROM STRUMENTOFINANZIARIO_BKP)
			]]></sql>
			<sql><![CDATA[

				MERGE INTO STRUMENTOFINANZIARIO S
				USING (SELECT * FROM STRUMENTOFINANZIARIO_BKP) B
				ON(S.CODICETITOLO=B.CODICETITOLO)
				WHEN MATCHED THEN UPDATE SET
					S.CODICEBANCA=B.CODICEBANCA,
					S.COMPOSIZIONE=B.COMPOSIZIONE,
					S.ISIN=B.ISIN,
					S.CODICEPROVIDER=B.CODICEPROVIDER,
					S.PROVIDER=B.PROVIDER,
					S.PIAZZA=B.PIAZZA,
					S.CLASSE=B.CLASSE,
					S.DESCRIZIONE=B.DESCRIZIONE,
					S.AREAGEOGRAFICA=B.AREAGEOGRAFICA,
					S.SETTORE=B.SETTORE,
					S.PEERGROUP=B.PEERGROUP,
					S.DURATA=B.DURATA,
					S.MATURITY=B.MATURITY,
					S.TIPOEMITTENTE=B.TIPOEMITTENTE,
					S.DIVISA=B.DIVISA,
					S.DIVISAEMITTENTE=B.DIVISAEMITTENTE,
					S.TIPO=B.TIPO,
					S.STATO=B.STATO,
					S.ORIGINE=B.ORIGINE,
					S.SGR=B.SGR,
					S.CAPITALIZZAZIONEEURO=B.CAPITALIZZAZIONEEURO,
					S.STILE=B.STILE,
					S.SCADENZA=B.SCADENZA,
					S.VAR=B.VAR,
					S.CVAR=B.CVAR,
					S.BETA=B.BETA,
					S.ISHEDGED=B.ISHEDGED,
					S.CODICECOMPARTO=B.CODICECOMPARTO,
					S.MODIFIEDDURATION=B.MODIFIEDDURATION,
					S.CONVEXITY=B.CONVEXITY,
					S.CREATORE=B.CREATORE,
					S.PAESE=B.PAESE,
					S.RATING=B.RATING,
					S.RATINGEMITTENTE=B.RATINGEMITTENTE,
					S.ASSETCLASS=B.ASSETCLASS,
					S.DELISTED=B.DELISTED,
					S.BENCHMARKDICHIARATO=B.BENCHMARKDICHIARATO,
					S.BENCHMARKASSOGESTIONI=B.BENCHMARKASSOGESTIONI,
					S.BENCHMARKINTERNO=B.BENCHMARKINTERNO,
					S.TIPOINDICE=B.TIPOINDICE,
					S.DATAINSERIMENTO=B.DATAINSERIMENTO,
					S.DATAAGGIORNAMENTO=B.DATAAGGIORNAMENTO,
					S.YTM=B.YTM,
					S.STARTDATE=B.STARTDATE,
					S.RISKENGINECODE=B.RISKENGINECODE,
					S.SPREAD=B.SPREAD,
					S.MACROTIPOLOGIA=B.MACROTIPOLOGIA,
					S.SOTTOTIPOLOGIA_1=B.SOTTOTIPOLOGIA_1,
					S.SOTTOTIPOLOGIA_2=B.SOTTOTIPOLOGIA_2,
					S.ALLOCABILE=B.ALLOCABILE,
					S.LOTTOMIN=B.LOTTOMIN,
					S.LOTTOMINSUCC=B.LOTTOMINSUCC,
					S.LOTTOMINRISP=B.LOTTOMINRISP,
					S.PAC=B.PAC,
					S.CLASSEESPERIENZA=B.CLASSEESPERIENZA,
					S.CLASSECONOSCENZA=B.CLASSECONOSCENZA,
					S.CLASSEINVESTIMENTO=B.CLASSEINVESTIMENTO,
					S.ISR=B.ISR,
					S.DIVISAEMISSIONE=B.DIVISAEMISSIONE,
					S.DIVISATRATTAZIONE=B.DIVISATRATTAZIONE,
					S.RENDITA=B.RENDITA,
					S.INVESTIMENTO=B.INVESTIMENTO,
					S.RENDIMENTO=B.RENDIMENTO,
					S.ESIGENZA=B.ESIGENZA,
					S.TIPOCEDOLA=B.TIPOCEDOLA,
					S.PROATTIVO=B.PROATTIVO,
					S.REATTIVO=B.REATTIVO,
					S.PREZZOEMI=B.PREZZOEMI,
					S.CODICEFONDO=B.CODICEFONDO,
					S.CAMBIOPARITA=B.CAMBIOPARITA,
					S.SEGMENTO=B.SEGMENTO,
					S.LIVELLO_1=B.LIVELLO_1,
					S.LIVELLO_2=B.LIVELLO_2,
					S.LIVELLO_3=B.LIVELLO_3,
					S.LIVELLO_4=B.LIVELLO_4,
					S.LIVELLO_5=B.LIVELLO_5,
					S.LIVELLO_6=B.LIVELLO_6,
					S.COSTO_GESTIONE=B.COSTO_GESTIONE,
					S.COSTI_USCITA=B.COSTI_USCITA,
					S.COSTI_ENTRATA=B.COSTI_ENTRATA,
					S.UL1Y=B.UL1Y,
					S.DATAEMISSIONE_INT=B.DATAEMISSIONE_INT,
					S.DATAINIZIO_CATCOM_MASS_INT=B.DATAINIZIO_CATCOM_MASS_INT,
					S.DATAFINE_CATCOM_MASS_INT=B.DATAFINE_CATCOM_MASS_INT,
					S.DATAINIZIO_CATCOM_TOPAFFLUENT_=B.DATAINIZIO_CATCOM_TOPAFFLUENT_,
					S.DATAFINE_CATCOM_TOPAFFLUENT_IN=B.DATAFINE_CATCOM_TOPAFFLUENT_IN,
					S.DATAINIZIO_CATCOM_PRIVATE_INT=B.DATAINIZIO_CATCOM_PRIVATE_INT,
					S.DATAFINE_CATCOM_PRIVATE_INT=B.DATAFINE_CATCOM_PRIVATE_INT,
					S.DATAINIZIO_CATCOM_PRIVATEHNWI_=B.DATAINIZIO_CATCOM_PRIVATEHNWI_,
					S.DATAFINE_CATCOM_PRIVATEHNWI_IN=B.DATAFINE_CATCOM_PRIVATEHNWI_IN,
					S.DATAINIZIO_CATCOM_ADD_INT=B.DATAINIZIO_CATCOM_ADD_INT,
					S.DATAFINE_CATCOM_ADD_INT=B.DATAFINE_CATCOM_ADD_INT,
					S.ISCATCOM_01015=B.ISCATCOM_01015,
					S.ISCATCOM_05256=B.ISCATCOM_05256,
					S.ISCATCOM_05387=B.ISCATCOM_05387,
					S.ISCATCOM_05392=B.ISCATCOM_05392,
					S.ISCATCOM_05414=B.ISCATCOM_05414,
					S.ISCATCOM_05550=B.ISCATCOM_05550,
					S.ISCATCOM_05640=B.ISCATCOM_05640,
					S.ISCATCOM_05676=B.ISCATCOM_05676,
					S.ISCATCOM_06040=B.ISCATCOM_06040,
					S.ISCATCOM_06365=B.ISCATCOM_06365,
					S.TITOLI_SECONDARI=B.TITOLI_SECONDARI,
					S.CODICERAGGR=B.CODICERAGGR,
					S.PREZZO_SECCO=B.PREZZO_SECCO,
					S.RATEO_MANTELLO=B.RATEO_MANTELLO,
					S.RATEO_CEDOLARE=B.RATEO_CEDOLARE,
					S.MOLTIPLICATORE=B.MOLTIPLICATORE,
					S.DATAULTIMORATEO=B.DATAULTIMORATEO,
					S.DATAULTIMOPREZZO=B.DATAULTIMOPREZZO,
					S.ILLIQUIDO=B.ILLIQUIDO,
					S.PRIORITACOMMERCIALE=B.PRIORITACOMMERCIALE,
					S.RAMO_VETRINA=B.RAMO_VETRINA,
					S.LIQUIDITA_R=B.LIQUIDITA_R,
					S.HP=B.HP,
					S.COMPONENTEDERIVATA=B.COMPONENTEDERIVATA,
					S.CONOSCENZADERIVATA=B.CONOSCENZADERIVATA,
					S.ESPERIENZADERIVATA=B.ESPERIENZADERIVATA,
					S.RAGGRHP=B.RAGGRHP,
					S.CONFLITTO=B.CONFLITTO,
					S.RAMO_VETRINA_2=B.RAMO_VETRINA_2,
					S.F_SCADENZA_FE=B.F_SCADENZA_FE,
					S.COSTO_FISSO=B.COSTO_FISSO,
					S.LOGICA_TMD=B.LOGICA_TMD,
					S.MODVERS=B.MODVERS,
					S.ISBLACKLIST=B.ISBLACKLIST,
					S.ISWHITELIST=B.ISWHITELIST,
					S.RAMOPOL=B.RAMOPOL,
					S.POLR3=B.POLR3,
					S.COD_PANIERE=B.COD_PANIERE,
					S.SOTTO_PANIERE=B.SOTTO_PANIERE,
					S.COD_SOTTO_PANIERE=B.COD_SOTTO_PANIERE,
					S.PERIMETRO=B.PERIMETRO,
					S.FREQ_CEDOLA=B.FREQ_CEDOLA,
					S.DATACED=B.DATACED,
					S.F_ACQUISTABILE=B.F_ACQUISTABILE,
					S.F_VENDIBILE=B.F_VENDIBILE,
					S.IS_WHITELIST=B.IS_WHITELIST,
					S.CAUSALE_PANIERE=B.CAUSALE_PANIERE,
					S.DATACHIUSURA=B.DATACHIUSURA,
					S.EMITTENTE=B.EMITTENTE,
					S.INDICATORELIQUIDITA=B.INDICATORELIQUIDITA,
					S.GMPERR3=B.GMPERR3,
					S.GMPOL3=B.GMPOL3,
					S.GMPOL11=B.GMPOL11,
					S.GMPOL12=B.GMPOL12,
					S.SCHEDAPRODOTTO=B.SCHEDAPRODOTTO,
					S.ISSWITCH=B.ISSWITCH,
					S.PERC_MAX_SWITCHOUT=B.PERC_MAX_SWITCHOUT,
					S.SWITCH_PRIORITARI=B.SWITCH_PRIORITARI,
					S.IS_BAILIN=B.IS_BAILIN,
					S.IS_BFPINDEXED=B.IS_BFPINDEXED
				    
			]]></sql>
			
			<sql><![CDATA[
				COMMIT
			]]></sql>
		</sqlProcess>
 	</task>
			
</job>
	